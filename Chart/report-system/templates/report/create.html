{% extends '_base.html' %}
{% load crispy_forms_tags %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title></title>
</head>
<body>
   {% block content %}




   <div >
    {% with url_name=request.resolver_match.url_name  %}

    {% if url_name == 'new_report' %}
    <form action="" method="post" enctype="multipart/form-data">

        {% csrf_token %}
    
        {{ form|crispy }}
    
    <button type="submit" value="save" class="btn btn-info btn-lg " ">Save</button>
    
    </form>

    {% elif url_name == 'report_list' %}
    <table  class="table table-striped  table-bordered table-hover">
        <thead>
            
        <tr >
            <th>ID</th>
            <th>Creator</th>
            <th> Sector</th>
            <th>KPI</th>
            <th>Starting Date</th>
            <th>Ending Date</th>
            
        </tr>
        </thead>
        <tbody>
                
                {% if reports %}
                    {% for report in reports %}
                    <tr onclick="location.href='{% url 'report_details' report.pk %}';">
                        
                        
                        <td>{{ report.id }}</td>
                        <td>{{ report.creator }}</td>
                        <td>{{ report.sector }}</td>
                        <td>{{ report.kpi }}</td>
                        <td>{{ report.from_to_date }}</td>
                        <td>{{ report.up_to_date }}</td>
                        
                        {% endfor %}

                    {% else %}
                    <td>
                     <span class='text-small align-content-center'>There's no report has been created by {{ user.username }}</span>
                    </td>
                {% endif %}
                    
                    
            </tr>
            
            </tbody>

    </table>
        {% elif url_name == 'report_details' %}
<!--startprint-->

        <table id="print" class="table table-striped table-bordered table-hover" >
            
            <thead>
                <tr>
                <th>ID</th>
                <th>Creator</th>
                <th>Sector</th>
                
                <th>KPI</th>
                <th>Start On</th>
                <th>End On</th>
            
                </tr>

            </thead>
            <tbody>
                <tr>
                    <td>{{ data.id }}</td>
                    <td>{{ data.creator }}</td>
                    <td>{{ data.sector }}</td>
                    <td>{{ data.kpi }}</td>
                    <td>{{ data.from_to_date }}</td>
                    <td>{{ data.up_to_date }}</td>


                </tr>
            </tbody>
        </table>
<!--endprint-->
        <form>
            <button type="button" value="Print" onclick="report_print()" class="btn btn-dark btn-lg">Print Report</button>
          </form>


    {% endif %}
    

 {% endwith %}

  </div>
  <script type="text/javascript">
        
    function report_print(){

        var bdhtml = window.document.body.innerHTML;
            var start = "<!--startprint-->";
            var end = "<!--endprint-->";
            var prnhtml = bdhtml.substr(bdhtml.indexOf(start) + 17);
            var prnhtml = prnhtml.substring(0, prnhtml.indexOf(end));
            prnhtml = "<h2 align=\"center\">Report</h2>" + prnhtml;
            window.document.body.innerHTML = prnhtml;
            window.print();
     
//       var print_report = document.getElementById("print");
// var print_area = window.open();
// print_area.document.write(print_report.outerHTML);
// print_area.document.close();
// print_area.focus();
// print_area.print();
// print_area.close();
// This is the code print a particular div element
    }
  </script>






   {% endblock content %}



   
</body>
</html>